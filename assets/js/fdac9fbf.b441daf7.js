"use strict";(globalThis.webpackChunktmp_docusaurus_project=globalThis.webpackChunktmp_docusaurus_project||[]).push([[7384],{2692:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"module-3/chapter-7","title":"Chapter 7: Inverse Kinematics and Humanoid Motion Planning","description":"\ud83c\udfaf Objective","source":"@site/docs/module-3/chapter-7.md","sourceDirName":"module-3","slug":"/module-3/chapter-7","permalink":"/roboailearner/docs/module-3/chapter-7","draft":false,"unlisted":false,"editUrl":"https://github.com/EngineerAbdullahIqbal/roboailearner/tree/main/robotics_book_content/docs/module-3/chapter-7.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 6: Sensor Fusion: Combining Data for Robust Perception","permalink":"/roboailearner/docs/module-2/chapter-6"},"next":{"title":"Chapter 8: Robot Control: Actuators, Joints, and PID","permalink":"/roboailearner/docs/module-3/chapter-8"}}');var o=t(4848),s=t(8453),r=t(6245);const a={},l="Chapter 7: Inverse Kinematics and Humanoid Motion Planning",c={},h=[{value:"\ud83c\udfaf Objective",id:"-objective",level:3},{value:"\ud83e\udde0 Theory: The Mathematics of Reaching",id:"-theory-the-mathematics-of-reaching",level:3},{value:"1. Forward Kinematics (FK)",id:"1-forward-kinematics-fk",level:4},{value:"2. Inverse Kinematics (IK)",id:"2-inverse-kinematics-ik",level:4},{value:"3. Motion Planning",id:"3-motion-planning",level:4},{value:"\ud83d\udee0\ufe0f Architecture: MoveIt 2",id:"\ufe0f-architecture-moveit-2",level:3},{value:"\ud83d\udcbb Implementation: Basic FK/IK with Python",id:"-implementation-basic-fkik-with-python",level:3},{value:"\u26a0\ufe0f Common Pitfalls (Sim vs. Real)",id:"\ufe0f-common-pitfalls-sim-vs-real",level:3},{value:"\ud83e\uddea Verification",id:"-verification",level:3},{value:"\ud83d\udcdd Chapter Summary",id:"-chapter-summary",level:3},{value:"\ud83d\udd1a Conclusion",id:"-conclusion",level:3}];function d(e){const n={code:"code",em:"em",h1:"h1",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"chapter-7-inverse-kinematics-and-humanoid-motion-planning",children:"Chapter 7: Inverse Kinematics and Humanoid Motion Planning"})}),"\n",(0,o.jsx)(n.h3,{id:"-objective",children:"\ud83c\udfaf Objective"}),"\n",(0,o.jsx)(n.p,{children:"This chapter dives into the geometry of movement. You will learn the difference between Forward Kinematics (FK) and Inverse Kinematics (IK), understand how to calculate joint angles to reach a specific point in space, and explore how motion planning frameworks like MoveIt 2 navigate complex humanoid bodies without collisions."}),"\n",(0,o.jsx)(n.h3,{id:"-theory-the-mathematics-of-reaching",children:"\ud83e\udde0 Theory: The Mathematics of Reaching"}),"\n",(0,o.jsx)(n.p,{children:"To a computer, a robot is a tree of coordinate frames connected by joints. Moving a hand to a coffee cup involves solving a complex geometric puzzle."}),"\n",(0,o.jsx)(n.h4,{id:"1-forward-kinematics-fk",children:"1. Forward Kinematics (FK)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Question:"}),' "If I set my shoulder to 45\xb0 and elbow to 90\xb0, where is my hand?"']}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Mechanism:"})," Chain of transformation matrices."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Difficulty:"})," Easy. There is always exactly one solution."]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"2-inverse-kinematics-ik",children:"2. Inverse Kinematics (IK)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Question:"}),' "I want my hand at (x, y, z) with orientation (roll, pitch, yaw). What joint angles do I need?"']}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Mechanism:"})," Solving non-linear equations (analytical or numerical)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Difficulty:"})," Hard.","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Multiple Solutions:"})," You can touch your nose with your elbow up or down."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"No Solution:"})," The target is out of reach."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Singularities:"})," Configurations where the robot loses a degree of freedom (e.g., arm fully extended), causing mathematical instability and potentially dangerous infinite velocities."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"3-motion-planning",children:"3. Motion Planning"}),"\n",(0,o.jsx)(n.p,{children:"Finding a path from Pose A to Pose B while avoiding obstacles (including the robot's own body). Algorithms like RRT* (Rapidly-exploring Random Tree) sample the configuration space to find a collision-free trajectory."}),"\n",(0,o.jsx)(n.h3,{id:"\ufe0f-architecture-moveit-2",children:"\ud83d\udee0\ufe0f Architecture: MoveIt 2"}),"\n",(0,o.jsxs)(n.p,{children:["ROS 2 uses ",(0,o.jsx)(n.strong,{children:"MoveIt 2"})," as the standard motion planning framework."]}),"\n","\n",(0,o.jsx)(r.A,{id:"7.1"}),"\n",(0,o.jsx)(n.h3,{id:"-implementation-basic-fkik-with-python",children:"\ud83d\udcbb Implementation: Basic FK/IK with Python"}),"\n",(0,o.jsx)(n.p,{children:"While MoveIt handles heavy lifting, understanding the math is crucial. We'll use a simple library to demonstrate."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'import numpy as np\n# Conceptual IK solver for a 2-link planar arm\n# Link lengths\nL1 = 1.0\nL2 = 1.0\n\ndef inverse_kinematics(x, y):\n    """\n    Calculate joint angles (theta1, theta2) to reach (x, y).\n    Using Law of Cosines.\n    """\n    dist = np.sqrt(x**2 + y**2)\n    \n    # Check reachability\n    if dist > (L1 + L2):\n        print("Target out of reach!")\n        return None, None\n\n    # Law of Cosines for elbow angle (theta2)\n    # c2 = (x^2 + y^2 - l1^2 - l2^2) / (2 * l1 * l2)\n    cos_theta2 = (x**2 + y**2 - L1**2 - L2**2) / (2 * L1 * L2)\n    theta2 = np.arccos(cos_theta2) # Elbow down solution\n\n    # Angle to target\n    phi = np.arctan2(y, x)\n    # Angle offset for shoulder\n    # sin_theta2 / dist = sin_alpha / l2  ?? No, use Law of Cosines again or trig\n    # k1 = L1 + L2 * cos_theta2\n    # k2 = L2 * sin_theta2\n    # theta1 = phi - arctan2(k2, k1)\n    \n    # Simplified geometric approach for theta1\n    beta = np.arccos((L1**2 + dist**2 - L2**2) / (2 * L1 * dist))\n    theta1 = phi - beta\n\n    return np.degrees(theta1), np.degrees(theta2)\n\n# Test\ntarget_x, target_y = 1.414, 1.414 # Should be roughly 45 deg reach\nt1, t2 = inverse_kinematics(target_x, target_y)\nprint(f"To reach ({target_x}, {target_y}): Shoulder={t1:.2f}\xb0, Elbow={t2:.2f}\xb0")\n'})}),"\n",(0,o.jsx)(n.h3,{id:"\ufe0f-common-pitfalls-sim-vs-real",children:"\u26a0\ufe0f Common Pitfalls (Sim vs. Real)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Simulation:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Ideal Geometry:"})," The robot model (URDF) matches the simulation perfectly."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"No Sag:"})," Joints are perfectly rigid."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Perfect Execution:"}),' If the planner says "move to X," the robot moves to X.']}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Reality:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Calibration Errors:"})," Real link lengths vary slightly due to manufacturing. The URDF might not match the physical robot, leading to IK errors (the hand isn't where the code thinks it is)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Backlash & Sag:"}),' Gearboxes have "play" (backlash). Heavy arms sag under gravity. A "perfect" IK solution might result in the end-effector being 2cm lower than expected.']}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Singularities:"})," Near singularities, motors might try to move at infinite speed. In sim, this might just look glitchy. In reality, this triggers over-current protection or damages hardware."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Self-Collision:"})," Cables and hoses aren't usually modeled in the collision scene. A valid plan might shear a cable in reality."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Kinematic Calibration:"})," Use tools to refine the URDF based on physical measurements."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Singularity Avoidance:"}),' Use "Manipulability" metrics in IK solvers to avoid singular configurations.']}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Safety Margins:"}),' Pad collision volumes (make the robot look "fatter" to the planner) to account for cables and calibration errors.']}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"-verification",children:"\ud83e\uddea Verification"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Visual Check (RViz):"}),' Use the "MotionPlanning" plugin in RViz. Drag the end-effector to a target. If the "ghost" robot follows, IK is working.']}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Plan & Execute:"}),' Click "Plan". Watch the visualized path. Ensure it doesn\'t pass through the robot body.']}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Tolerance Check:"}),' On the real robot, measure the actual end-effector position vs. the requested position. The difference is your "Kinematic Error".']}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"-chapter-summary",children:"\ud83d\udcdd Chapter Summary"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Kinematics"})," relates joint angles to end-effector position. ",(0,o.jsx)(n.strong,{children:"Forward (FK)"})," is simple (angles -> position); ",(0,o.jsx)(n.strong,{children:"Inverse (IK)"})," is complex (position -> angles)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Motion Planning"})," algorithms like RRT* find collision-free paths in high-dimensional spaces."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"MoveIt 2"})," is the standard ROS 2 framework for managing kinematics, planning, and collision checking."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Real-world challenges"})," include mechanical backlash, calibration discrepancies (URDF vs. Hardware), and unmodeled obstacles like cables."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"-conclusion",children:"\ud83d\udd1a Conclusion"}),"\n",(0,o.jsxs)(n.p,{children:["Mastering Inverse Kinematics and Motion Planning is the first step in giving a humanoid robot agency. Without it, a robot is just a statue. However, the mathematical precision of an IK solver often crashes against the messy reality of mechanical imperfections. As you move to the next chapter on Control, remember that ",(0,o.jsx)(n.em,{children:"planning"})," a motion is only half the battle; ",(0,o.jsx)(n.em,{children:"executing"})," it against gravity and friction is where the physics truly kicks in."]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},6245:(e,n,t)=>{t.d(n,{A:()=>x});var i=t(6540),o=t(4922),s=t(9437),r=t(7024);class a{frameId=null;constructor(e){this.container=e;try{this.renderer=new s.JeP({antialias:!0,alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(e.clientWidth,e.clientHeight),this.renderer.domElement.tabIndex=0,this.renderer.domElement.style.outline="none",e.appendChild(this.renderer.domElement)}catch(i){throw new Error("WebGL is not supported in this browser.")}this.scene=new o.Z58,this.scene.background=new o.Q1f(15790320),this.camera=new o.ubm(45,e.clientWidth/e.clientHeight,.1,1e3),this.camera.position.set(0,5,10),this.camera.lookAt(0,0,0),this.controls=new r.N(this.camera,this.renderer.domElement),this.controls.enableDamping=!0;const n=new o.$p8(16777215,.6);this.scene.add(n);const t=new o.ZyN(16777215,.8);t.position.set(5,10,5),this.scene.add(t),window.addEventListener("resize",this.onWindowResize)}onWindowResize=()=>{this.container&&(this.camera.aspect=this.container.clientWidth/this.container.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight))};start(){this.frameId||this.animate()}stop(){this.frameId&&(cancelAnimationFrame(this.frameId),this.frameId=null)}animate=()=>{this.frameId=requestAnimationFrame(this.animate),this.controls.update(),this.renderer.render(this.scene,this.camera)};getScene(){return this.scene}getCamera(){return this.camera}getControls(){return this.controls}dispose(){this.stop(),window.removeEventListener("resize",this.onWindowResize),this.renderer.dispose(),this.container.contains(this.renderer.domElement)&&this.container.removeChild(this.renderer.domElement)}}class l{manifest=null;constructor(e="/3d/manifest.json"){this.manifestUrl=e}async loadManifest(){if(this.manifest)return this.manifest;try{const e=await fetch(this.manifestUrl);if(!e.ok)throw new Error(`Failed to load manifest: ${e.statusText}`);return this.manifest=await e.json(),this.manifest}catch(e){throw console.error("SceneLoader error:",e),e}}getSceneConfig(e){return this.manifest?.scenes[e]}}class c{nodes=new Map;constructor(e){this.scene=e}build(e){this.clear(),e.nodes.forEach(e=>{const n=this.createNode(e);this.scene.add(n),this.nodes.set(e.id,n)}),e.edges.forEach(e=>{const n=this.nodes.get(e.from),t=this.nodes.get(e.to);if(n&&t){const i=this.createEdge(n.position,t.position,e);this.scene.add(i)}})}createNode(e){let n;switch(e.type){case"sphere":n=new o.Gu$(.5,32,32);break;case"cylinder":n=new o.Ho_(.5,.5,1,32);break;default:n=new o.iNn(1,1,1)}const t=new o._4j({color:e.color||"#007bff",roughness:.7,metalness:.3}),i=new o.eaF(n,t);return i.position.set(...e.pos),i.userData={id:e.id,label:e.label,isNode:!0},i}createEdge(e,n,t){const i=new o.VnP(e,n),s=new o.j6(i,20,.05,8,!1),r=new o.V9B({color:t.color||"#999",transparent:!0,opacity:.6});return new o.eaF(s,r)}clear(){this.nodes.clear()}}var h=t(2763);class d{robotModel=null;annotations=new Map;constructor(e){this.scene=e,this.loader=new h.B}async build(e,n){return this.clear(),new Promise((t,i)=>{this.loader.load(n,n=>{this.robotModel=n.scene,this.scene.add(this.robotModel),e.highlight_bones&&e.highlight_bones.forEach(e=>{const n=this.robotModel?.getObjectByName(e);if(n){const e=new o.IzY(.5);n.add(e)}}),t()},void 0,e=>{console.error("An error happened loading the robot model:",e);const n=new o.iNn(1,2,1),i=new o._4j({color:8947848});this.robotModel=new o.eaF(n,i),this.scene.add(this.robotModel),t()})})}getAnnotationPositions(e){const n=[];return this.robotModel&&e.annotations?(e.annotations.forEach(e=>{const t=this.robotModel.getObjectByName(e.target_bone);if(t){const i=new o.Pq0;t.getWorldPosition(i),n.push({id:e.id,position:i})}else console.warn(`Bone ${e.target_bone} not found for annotation ${e.id}`)}),n):n}clear(){this.robotModel&&(this.scene.remove(this.robotModel),this.robotModel=null)}}class u{pointCloud=null;constructor(e){this.scene=e}build(e){this.clear(),e.source_image?this.buildFromImage(e.source_image):this.buildRandom()}buildRandom(){const e=new o.LoY,n=5e3,t=new Float32Array(15e3),i=new Float32Array(15e3);for(let o=0;o<n;o++){const e=10*(Math.random()-.5),n=10*(Math.random()-.5),s=10*(Math.random()-.5);t[3*o]=e,t[3*o+1]=n,t[3*o+2]=s,i[3*o]=(e+5)/10,i[3*o+1]=(n+5)/10,i[3*o+2]=(s+5)/10}e.setAttribute("position",new o.THS(t,3)),e.setAttribute("color",new o.THS(i,3));const s=new o.BH$({size:.1,vertexColors:!0});this.pointCloud=new o.ONl(e,s),this.scene.add(this.pointCloud)}buildFromImage(e){(new o.Tap).load(e,e=>{const n=100,t=100,i=new o.LoY,s=new Float32Array(3e4),r=document.createElement("canvas");r.width=e.image.width,r.height=e.image.height;const a=r.getContext("2d");if(a){a.drawImage(e.image,0,0);const l=a.getImageData(0,0,r.width,r.height).data;let c=0;for(let i=0;i<n;i++)for(let o=0;o<t;o++){const r=.1*(i-50),a=.1*(o-50),h=Math.floor(i/n*e.image.width),d=5*(l[4*(Math.floor(o/t*e.image.height)*e.image.width+h)]/255);s[c]=r,s[c+1]=a,s[c+2]=d,c+=3}i.setAttribute("position",new o.THS(s,3));const h=new o.BH$({size:.05,color:65535});this.pointCloud=new o.ONl(i,h),this.scene.add(this.pointCloud)}})}clear(){this.pointCloud&&(this.scene.remove(this.pointCloud),this.pointCloud.geometry.dispose(),this.pointCloud.material.dispose(),this.pointCloud=null)}}var m=t(8478),g=t(6025),p=t(4848);const f=({id:e,height:n="400px",width:t="100%",fallbackImage:s})=>{const r=(0,i.useRef)(null),h=(0,i.useRef)(null),[m,f]=(0,i.useState)(null),[x,b]=(0,i.useState)(!0),[j,w]=(0,i.useState)([]),y=(0,i.useRef)(),v=(0,g.Ay)("/3d/manifest.json");return(0,i.useEffect)(()=>{let n=!0;return(async()=>{if(r.current)try{h.current=new a(r.current);const t=new l(v);await t.loadManifest();const i=t.getSceneConfig(e);if(!i)throw new Error(`Scene ID "${e}" not found in manifest.`);if(!n)return;if(i.camera){const e=h.current.getCamera();e.position.set(...i.camera.position),e.lookAt(...i.camera.target),i.camera.fov&&(e.fov=i.camera.fov),e.updateProjectionMatrix()}if("flow"===i.type){new c(h.current.getScene()).build(i.config);const e=[];i.config.nodes.forEach(n=>{e.push({id:n.id,text:n.label,position:new o.Pq0(...n.pos)})}),w(e)}else if("robot"===i.type){const e=new d(h.current.getScene()),n=i.config.model,t=i.assets?.find(e=>e.id===n),o=t?t.url:"";await e.build(i.config,o);const s=e.getAnnotationPositions(i.config),r=[];i.config.annotations?.forEach(e=>{const n=s.find(n=>n.id===e.id);n&&r.push({id:e.id,text:e.text||e.label,position:n.position})}),w(r)}else if("pointcloud"===i.type){new u(h.current.getScene()).build(i.config)}h.current.start(),b(!1)}catch(t){console.error("ThreeDiagram Init Error:",t),n&&f(t instanceof Error?t.message:String(t))}})(),()=>{n=!1,y.current&&cancelAnimationFrame(y.current),h.current&&(h.current.dispose(),h.current=null)}},[e]),(0,i.useEffect)(()=>{if(0===j.length||!h.current)return;const n=()=>{if(!h.current||!r.current)return;const t=h.current.getCamera(),i=r.current.clientWidth,o=r.current.clientHeight,s=i/2,a=o/2;j.forEach(n=>{const i=document.getElementById(`label-${e}-${n.id}`);if(!i)return;const o=n.position.clone();if(o.y+=.8,o.project(t),o.z<1){i.style.display="block";const e=o.x*s+s,n=-o.y*a+a;i.style.transform=`translate(-50%, -50%) translate(${e}px, ${n}px)`}else i.style.display="none"}),y.current=requestAnimationFrame(n)};return n(),()=>{y.current&&cancelAnimationFrame(y.current)}},[j,e]),m?(0,p.jsx)("div",{style:{width:t,height:n,background:"#f8d7da",color:"#721c24",padding:"20px",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #f5c6cb",borderRadius:"4px"},children:(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Error loading 3D Diagram:"})," ",m,s&&(0,p.jsx)("img",{src:s,alt:"Fallback",style:{maxWidth:"100%",marginTop:"10px"}})]})}):(0,p.jsxs)("div",{style:{position:"relative",width:t,height:n,overflow:"hidden",borderRadius:"8px",border:"1px solid #ddd",background:"#f0f0f0"},role:"region","aria-label":`Interactive 3D Diagram: ${e}`,children:[x&&(0,p.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"#eee",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},children:"Loading 3D Scene..."}),(0,p.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"hidden"},children:j.map(n=>(0,p.jsx)("div",{id:`label-${e}-${n.id}`,style:{position:"absolute",top:0,left:0,background:"rgba(255, 255, 255, 0.8)",padding:"2px 6px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",color:"#333",boxShadow:"0 1px 3px rgba(0,0,0,0.2)",whiteSpace:"nowrap",display:"none",willChange:"transform"},children:n.text},n.id))}),(0,p.jsx)("div",{ref:r,style:{width:"100%",height:"100%"},"aria-label":`3D Diagram: ${e}`,role:"img"})]})};function x(e){return(0,p.jsx)(m.A,{fallback:(0,p.jsx)("div",{style:{height:e.height||"400px",background:"#eee"},children:"Loading..."}),children:()=>(0,p.jsx)(f,{...e})})}}}]);